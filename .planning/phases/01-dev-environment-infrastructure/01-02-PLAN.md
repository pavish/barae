---
phase: 01-dev-environment-infrastructure
plan: 02
type: execute
wave: 2
depends_on: []
files_modified:
  - frontend/package.json
  - frontend/package-lock.json
  - frontend/vite.config.ts
  - frontend/tsconfig.app.json
  - frontend/tsconfig.json
  - frontend/components.json
  - frontend/src/index.css
  - frontend/src/main.tsx
  - frontend/src/app.tsx
  - frontend/src/lib/utils.ts
  - frontend/src/lib/queryClient.ts
  - frontend/src/lib/api.ts
  - frontend/src/pages/.gitkeep
  - frontend/src/hooks/.gitkeep
  - frontend/src/stores/.gitkeep
  - frontend/src/types/.gitkeep
  - frontend/.env.example
  - frontend/eslint.config.js
autonomous: true

must_haves:
  truths:
    - "Frontend builds successfully with very strict TypeScript (noUncheckedIndexedAccess + exactOptionalPropertyTypes)"
    - "shadcn/ui is initialized with Tailwind v4 and components can be added via CLI"
    - "Vite dev server listens on 0.0.0.0:5173 (accessible from Docker network)"
    - "Import path alias @/ resolves to src/ in both TypeScript and Vite"
    - "Frontend directory structure has pages/, hooks/, stores/, lib/, types/ directories"
    - "No env variables used in frontend code"
    - "TanStack Query client is configured and ready"
  artifacts:
    - path: "frontend/components.json"
      provides: "shadcn/ui configuration"
      contains: "shadcn"
    - path: "frontend/src/lib/utils.ts"
      provides: "cn() utility from shadcn/ui"
      contains: "clsx"
    - path: "frontend/src/lib/queryClient.ts"
      provides: "TanStack Query client configuration"
      contains: "QueryClient"
    - path: "frontend/src/app.tsx"
      provides: "Root component with QueryClientProvider"
      contains: "QueryClientProvider"
    - path: "frontend/vite.config.ts"
      provides: "Vite config with path alias and Docker-friendly server settings"
      contains: "0.0.0.0"
  key_links:
    - from: "frontend/src/main.tsx"
      to: "frontend/src/app.tsx"
      via: "import App"
      pattern: "import.*App.*from.*app"
    - from: "frontend/src/app.tsx"
      to: "frontend/src/lib/queryClient.ts"
      via: "import queryClient"
      pattern: "import.*queryClient"
    - from: "frontend/tsconfig.app.json"
      to: "frontend/vite.config.ts"
      via: "path alias @/ in both"
      pattern: "@/\\*"
---

<objective>
Set up the frontend foundation: initialize shadcn/ui with Tailwind v4, configure Vite for Docker development, add import path aliases, tighten TypeScript to very strict mode, install zustand, set up TanStack Query client, create the directory structure, and remove the old frontend .env.example.

Purpose: Establish the frontend tooling and structure that all future UI phases build upon.
Output: Frontend with shadcn/ui ready, strict TypeScript, Docker-friendly Vite config, and organized directory structure.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/codebase/STANDARDS.md
@.planning/phases/01-dev-environment-infrastructure/01-CONTEXT.md
@.planning/phases/01-dev-environment-infrastructure/01-RESEARCH.md
@frontend/package.json
@frontend/vite.config.ts
@frontend/tsconfig.json
@frontend/tsconfig.app.json
@frontend/tsconfig.node.json
@frontend/src/main.tsx
@frontend/index.html
@frontend/eslint.config.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install dependencies + initialize shadcn/ui + TypeScript strictness</name>
  <files>frontend/package.json, frontend/package-lock.json, frontend/components.json, frontend/src/index.css, frontend/src/lib/utils.ts, frontend/tsconfig.app.json, frontend/tsconfig.json, frontend/eslint.config.js</files>
  <action>
  1. Install new dependencies:
     ```bash
     cd frontend
     npm install zustand
     npm install -D prettier eslint-config-prettier
     ```

  2. Initialize shadcn/ui. Run the shadcn init command:
     ```bash
     cd frontend
     npx shadcn@latest init
     ```
     When prompted (or via flags if non-interactive):
     - Style: new-york (default is deprecated)
     - Base color: neutral (or zinc -- user can change later)
     - CSS variables: yes
     - Use `--defaults` or `-y` flag if available to accept defaults

     This will:
     - Create `components.json`
     - Create/update `src/lib/utils.ts` with the `cn()` function
     - Update `src/index.css` with Tailwind v4 theme variables (OKLCH colors, @theme inline)
     - May install additional deps (clsx, tailwind-merge, class-variance-authority, tw-animate-css)

     If the interactive mode causes issues, create the files manually:
     - `components.json` pointing to `src/components/ui`, `src/lib/utils.ts`, Tailwind CSS path `src/index.css`
     - `src/lib/utils.ts` with:
       ```typescript
       import { type ClassValue, clsx } from "clsx"
       import { twMerge } from "tailwind-merge"

       export function cn(...inputs: ClassValue[]) {
         return twMerge(clsx(inputs))
       }
       ```

  3. Update `frontend/tsconfig.app.json` to add very strict settings and path alias:
     Add to compilerOptions:
     - `"noUncheckedIndexedAccess": true`
     - `"exactOptionalPropertyTypes": true`
     - `"baseUrl": "."`
     - `"paths": { "@/*": ["./src/*"] }`

  4. Update `frontend/tsconfig.json` to add path alias at root level (some tools read this):
     Add `"compilerOptions": { "baseUrl": ".", "paths": { "@/*": ["./src/*"] } }` alongside the existing references.

  5. Add prettier config to `frontend/eslint.config.js` -- add eslint-config-prettier to the extends chain to disable ESLint rules that conflict with Prettier. Follow the existing backend eslint.config.js pattern.

  6. Fix any TypeScript errors caused by the new strict settings. Common issues:
     - `strictMode` prop in React -- not an issue
     - Potential issues with `document.getElementById('root')!` -- the `!` assertion is fine
  </action>
  <verify>
  - `ls frontend/components.json` -- shadcn config exists
  - `cat frontend/src/lib/utils.ts` -- cn() function exists
  - `grep "noUncheckedIndexedAccess" frontend/tsconfig.app.json` -- strict setting present
  - `grep "exactOptionalPropertyTypes" frontend/tsconfig.app.json` -- strict setting present
  - `grep '"@/\\*"' frontend/tsconfig.app.json` -- path alias configured
  - `grep "zustand" frontend/package.json` -- zustand installed
  - `cd frontend && npx tsc --noEmit` -- no TypeScript errors
  </verify>
  <done>shadcn/ui initialized, TypeScript very strict with path aliases, zustand installed, prettier configured.</done>
</task>

<task type="auto">
  <name>Task 2: Configure Vite + create app scaffold + directory structure + cleanup</name>
  <files>frontend/vite.config.ts, frontend/src/main.tsx, frontend/src/app.tsx, frontend/src/lib/queryClient.ts, frontend/src/lib/api.ts, frontend/src/pages/.gitkeep, frontend/src/hooks/.gitkeep, frontend/src/stores/.gitkeep, frontend/src/types/.gitkeep, frontend/.env.example</files>
  <action>
  1. Update `frontend/vite.config.ts`:
     ```typescript
     import path from 'path'
     import tailwindcss from '@tailwindcss/vite'
     import react from '@vitejs/plugin-react'
     import { defineConfig } from 'vite'

     export default defineConfig({
       plugins: [react(), tailwindcss()],
       server: {
         host: '0.0.0.0',       // Listen on all interfaces (required for Docker)
         port: 5173,
         strictPort: true,       // Fail if port is taken
       },
       resolve: {
         alias: {
           '@': path.resolve(__dirname, './src'),
         },
       },
     })
     ```
     Key changes from existing:
     - Add `host: '0.0.0.0'` for Docker accessibility
     - Add `strictPort: true`
     - Add `resolve.alias` for `@/` path alias
     - REMOVE the `proxy` configuration (Caddy handles routing, Vite no longer proxies /api)
     - Add `path` import

  2. Create `frontend/src/lib/queryClient.ts`:
     ```typescript
     import { QueryClient } from '@tanstack/react-query'

     export const queryClient = new QueryClient({
       defaultOptions: {
         queries: {
           staleTime: 5 * 60 * 1000,   // 5 minutes
           retry: 1,
         },
       },
     })
     ```

  3. Create `frontend/src/lib/api.ts` -- a minimal fetch wrapper for API calls:
     ```typescript
     const API_BASE = '/api'

     export async function apiFetch<T>(
       path: string,
       options?: RequestInit,
     ): Promise<T> {
       const response = await fetch(`${API_BASE}${path}`, {
         headers: {
           'Content-Type': 'application/json',
           ...options?.headers,
         },
         credentials: 'include',
         ...options,
       })

       if (!response.ok) {
         const error = await response.json().catch(() => ({ message: response.statusText }))
         throw new Error(error.message || `API error: ${response.status}`)
       }

       return response.json() as Promise<T>
     }
     ```
     This uses relative `/api` path -- Caddy routes it to the backend. No env variables needed.

  4. Create `frontend/src/app.tsx` -- root component with QueryClientProvider:
     ```typescript
     import { QueryClientProvider } from '@tanstack/react-query'
     import { queryClient } from '@/lib/queryClient'

     export default function App() {
       return (
         <QueryClientProvider client={queryClient}>
           <div>
             <h1>Barae</h1>
             <p>Dashboard coming in Phase 3</p>
           </div>
         </QueryClientProvider>
       )
     }
     ```

  5. Update `frontend/src/main.tsx`:
     - Change import from `'./App.tsx'` to `'@/app'` (use the @/ alias, camelCase filename convention)
     - Remove `import './index.css'` if it exists (move CSS import into app.tsx or keep in main.tsx -- keeping in main.tsx is fine as it's the entry point)
     - Actually, keep `import './index.css'` in main.tsx (Vite entry point pattern)
     - Fix import: `import App from '@/app'`

  6. Create directory structure with .gitkeep placeholders:
     - `frontend/src/pages/.gitkeep`
     - `frontend/src/hooks/.gitkeep`
     - `frontend/src/stores/.gitkeep`
     - `frontend/src/types/.gitkeep`
     - `frontend/src/components/` should already exist from shadcn init (with ui/ subdir)

  7. Delete `frontend/.env.example` -- frontend never uses env variables (per STANDARDS.md Priority Rule #2). This file contains `VITE_API_URL` which violates the standard.

  8. Delete `frontend/src/assets/` directory if it only contains placeholder files -- we don't need it. If it has actual assets, leave it.

  9. Delete `frontend/src/App.tsx` if it exists (replaced by `frontend/src/app.tsx` -- note camelCase per naming convention). Also delete `frontend/src/App.css` if it exists.
  </action>
  <verify>
  - `cat frontend/vite.config.ts` -- shows host: '0.0.0.0', no proxy config, has resolve.alias
  - `cat frontend/src/lib/queryClient.ts` -- QueryClient configured
  - `cat frontend/src/lib/api.ts` -- fetch wrapper using /api base path
  - `cat frontend/src/app.tsx` -- root component with QueryClientProvider
  - `cat frontend/src/main.tsx` -- imports from @/app
  - `ls frontend/src/pages frontend/src/hooks frontend/src/stores frontend/src/types` -- directories exist
  - `test ! -f frontend/.env.example` -- frontend .env.example deleted
  - `cd frontend && npx tsc --noEmit` -- no TypeScript errors
  - `cd frontend && npx vite build` -- build succeeds
  </verify>
  <done>Vite configured for Docker, proxy removed, @/ alias works, app scaffold with QueryClientProvider, directory structure created, frontend .env.example removed.</done>
</task>

</tasks>

<verification>
1. `cd frontend && npx tsc --noEmit` -- TypeScript compiles with very strict settings
2. `cd frontend && npx vite build` -- production build succeeds
3. `cat frontend/components.json` -- shadcn/ui initialized
4. `grep "0.0.0.0" frontend/vite.config.ts` -- Docker-friendly host
5. `grep "proxy" frontend/vite.config.ts` -- no proxy config (should return nothing)
6. `test ! -f frontend/.env.example` -- no frontend .env file
7. `ls frontend/src/pages frontend/src/hooks frontend/src/stores frontend/src/lib frontend/src/types` -- all directories exist
</verification>

<success_criteria>
- Frontend builds (tsc and vite build) with no errors under very strict TypeScript
- shadcn/ui initialized with cn() utility and theme variables
- Vite listens on 0.0.0.0:5173 (Docker accessible) with no proxy config
- @/ import alias works in both TypeScript and Vite
- TanStack Query client configured
- Directory structure matches planned layout (pages, hooks, stores, lib, types, components/ui)
- No .env.example in frontend/
- zustand installed
</success_criteria>

<output>
After completion, create `.planning/phases/01-dev-environment-infrastructure/01-02-SUMMARY.md`
</output>
